@isTest
public class PG_CredentialscntrlTest{
    @testsetup
    static void createCase(){
        Order_Items__c ord=new Order_Items__c();
       
        ord.Order_Item_Reference_No__c ='Tn12345678';
        ord.Payment_Details__c='{"id":13473197457266714,"orderId":13473197457266714,"uuid":"a78dbb03fbb9f0054c27f30c02010500","creationTime":"2023-05-15T11:21:22","businessUnit":"REDBUS_ID","orderValue":{"currencyType":"IDR","amount":529},"amountReceivable":{"currencyType":"IDR","amount":0},"amountPaid":{"currencyType":"IDR","amount":529},"refundableSurplus":{"currencyType":"IDR","amount":0},"paymentItemList":[{"id":13473197622403436,"orderId":13473197457266714,"uuid":"a8c8b42dfbb9f0054c27f30c04030500","refunds":null,"businessUnitValue":{"currencyType":"IDR","amount":529},"paymentItemValue":{"currencyType":"IDR","amount":529},"paymentStatus":"COMPLETED","paymentSessionId":13473197457266714,"paymentSystem":"RBOFFER","paymentSystemRefNo":"DBT","updatedBy":"","creationTime":"2023-05-15T11:21:42","pgName":"","pgtype":"","cardNo":"","bankName":"","bankAccountNumber":"","accountHolderName":"","bank_ref_num":"","itemUuids":["a78dc578fbb9f0054c27f30c01020500"],"paymentSubType":"","_meta":{"version":null,"confirm_millisecond":""}},{"id":13473197629411001,"orderId":13473197457266714,"uuid":"a8d611d7fbb9f005d93dc8e301030500","refunds":[{"reason":"gft_refund-multiple item state","updatedBy":"","refundedBy":"","refundType":"ONLINE","refundTime":1684322571083014,"refundStatus":"REFUND_CREATED","refundAmount":{"currencyType":"IDR","amount":504471},"refundCreationTime":"2023-05-17T11:22:51","refundCategory":"GFT","order_item_uuid":"b03f3ff2fbb9f00585344c3004020500","channel":"OMS","refNo":"","orderItemId":0,"index":1}],"businessUnitValue":{"currencyType":"IDR","amount":504471},"paymentItemValue":{"currencyType":"IDR","amount":504471},"paymentStatus":"COMPLETED","paymentSessionId":13473197457266714,"paymentSystem":"ONLINE","paymentSystemRefNo":"21838021","updatedBy":"CAPI","creationTime":"2023-05-15T11:21:49","pgName":"BankTransfer","pgtype":"BankTransfer","cardNo":"","bankName":"BCA","bankAccountNumber":"2063 335 002","accountHolderName":"IBIBO GROUP INDONESIA PT","bank_ref_num":"","itemUuids":null,"paymentSubType":"","_meta":{"version":null,"confirm_millisecond":""}}]}';
        insert ord;
      } 
    
    static testMethod void caseTest()
    {
       Test.startTest();
        Order_Items__c ordrtem=[select Order_Item_Reference_No__c,Payment_Details__c from Order_Items__c limit 1];
        string json ='{"id":13473197457266714,"orderId":13473197457266714,"uuid":"a78dbb03fbb9f0054c27f30c02010500","creationTime":"2023-05-15T11:21:22","businessUnit":"REDBUS_ID","orderValue":{"currencyType":"IDR","amount":529},"amountReceivable":{"currencyType":"IDR","amount":0},"amountPaid":{"currencyType":"IDR","amount":529},"refundableSurplus":{"currencyType":"IDR","amount":0},"paymentItemList":[{"id":13473197622403436,"orderId":13473197457266714,"uuid":"a8c8b42dfbb9f0054c27f30c04030500","refunds":null,"businessUnitValue":{"currencyType":"IDR","amount":529},"paymentItemValue":{"currencyType":"IDR","amount":529},"paymentStatus":"COMPLETED","paymentSessionId":13473197457266714,"paymentSystem":"RBOFFER","paymentSystemRefNo":"DBT","updatedBy":"","creationTime":"2023-05-15T11:21:42","pgName":"","pgtype":"","cardNo":"","bankName":"","bankAccountNumber":"","accountHolderName":"","bank_ref_num":"","itemUuids":["a78dc578fbb9f0054c27f30c01020500"],"paymentSubType":"","_meta":{"version":null,"confirm_millisecond":""}},{"id":13473197629411001,"orderId":13473197457266714,"uuid":"a8d611d7fbb9f005d93dc8e301030500","refunds":[{"reason":"gft_refund-multiple item state","updatedBy":"","refundedBy":"","refundType":"ONLINE","refundTime":1684322571083014,"refundStatus":"REFUND_CREATED","refundAmount":{"currencyType":"IDR","amount":504471},"refundCreationTime":"2023-05-17T11:22:51","refundCategory":"GFT","order_item_uuid":"b03f3ff2fbb9f00585344c3004020500","channel":"OMS","refNo":"","orderItemId":0,"index":1}],"businessUnitValue":{"currencyType":"IDR","amount":504471},"paymentItemValue":{"currencyType":"IDR","amount":504471},"paymentStatus":"COMPLETED","paymentSessionId":13473197457266714,"paymentSystem":"ONLINE","paymentSystemRefNo":"21838021","updatedBy":"CAPI","creationTime":"2023-05-15T11:21:49","pgName":"BankTransfer","pgtype":"BankTransfer","cardNo":"","bankName":"BCA","bankAccountNumber":"2063 335 002","accountHolderName":"IBIBO GROUP INDONESIA PT","bank_ref_num":"","itemUuids":null,"paymentSubType":"","_meta":{"version":null,"confirm_millisecond":""}}]}';
        PG_Credentialscntrl.getPGdetails(ordrtem.id);
        string pglink=PG_Credentialscntrl.dblogToCapturedata(ordrtem.Order_Item_Reference_No__c,'testt','1','tset');
        test.stopTest();
        
    }   
    
 }